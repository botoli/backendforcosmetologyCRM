PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE users (

    id INTEGER PRIMARY KEY AUTOINCREMENT,

    email VARCHAR(255) UNIQUE NOT NULL,

    phone VARCHAR(20) UNIQUE NOT NULL,

    password_hash VARCHAR(255) NOT NULL,

    name VARCHAR(100) NOT NULL,

    surname VARCHAR(100) NOT NULL,

    role VARCHAR(20) DEFAULT 'client' CHECK(role IN ('client', 'admin')),

    telegram_id VARCHAR(100) UNIQUE,

    telegram_username VARCHAR(100),

    is_active BOOLEAN DEFAULT TRUE,

    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,

    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP

);
INSERT INTO users VALUES(19,'StIrin-ka@yandex.ru','+79254439529','$2a$10$Kh1q3rYWF9.5ZT7OIBWwGeB.UDEYbArYDktSJt8CkuVJrXl/Ih7da','?Р???????????Б?В?А???В???А','?б???Б?В?????Л','admin','7780599269','bobolie',1,'2025-10-27 00:32:36','2025-10-27 00:32:36');
INSERT INTO users VALUES(22,'standrey2007@gmail.com','89689370544','$2a$10$aT9w4nJuiUtstfZ0Ab47Se87z5frrnyOYbWi72zuASgu/jHu/KTGe','?Р?????А????','qwe','client','964264865','Grmmy',1,'2025-10-27 10:48:03','2025-10-27 10:48:03');
CREATE TABLE services (

    id INTEGER PRIMARY KEY AUTOINCREMENT,

    name VARCHAR(255) NOT NULL,

    category VARCHAR(100) NOT NULL,

    description TEXT,

    price DECIMAL(10,2) NOT NULL,

    duration INTEGER NOT NULL, -- ?? ???????Г?В???Е

    is_active BOOLEAN DEFAULT TRUE,

    created_at DATETIME DEFAULT CURRENT_TIMESTAMP

);
INSERT INTO services VALUES(1,'?г???М?В?А???????Г?????????П ?З???Б?В???? ?????Ж??','?з???Б?В???? ?????Ж??','?У???Г?????????П ???З???Б?В???? ?????А ?Б ?????????Й?М?О ?Г???М?В?А???????Г????',1800,60,1,'2025-10-26 19:17:30');
INSERT INTO services VALUES(2,'?Ъ?????????????А?????????????П ?З???Б?В???? ?????Ж??','?з???Б?В???? ?????Ж??','?Ъ?????????????Б?????П ?З???Б?В???? ?Б ?А?Г?З?????? ?? ?????????А???В?????? ?????А???????В??????',2500,90,1,'2025-10-26 19:17:30');
INSERT INTO services VALUES(3,'?Ь???Б?Б???? ?????Ж?? ???????????????А???????????Л??','?Ь???Б?Б???? ?????Ж??','?а???Б?Б?????????П?О?Й???? ?? ?В???????????А?Г?О?Й???? ?????Б?Б????',1500,45,1,'2025-10-26 19:17:30');
INSERT INTO services VALUES(4,'S-?Г?Е????','?г?Е???? ?????Ж?? ?Б ?????Б?Б????????','?С?????????Л?? ?Г?Е???? ???? ?????????? ?????Ж??',1500,45,1,'2025-10-26 19:17:30');
INSERT INTO services VALUES(41,'M-?Г?Е????','?г?Е???? ?????Ж?? ?Б ?????Б?Б????????','?Я?А???????????Г?В?Л?? ?Г?Е???? ???? ?????????? ?????Ж??',2000,60,1,'2025-10-26 19:41:28');
INSERT INTO services VALUES(42,'L-?Г?Е????','?г?Е???? ?????Ж?? ?Б ?????Б?Б????????','?Я?А???????????М???Л?? ?Г?Е???? ???? ?????????? ?????Ж??',2700,90,1,'2025-10-26 19:41:28');
INSERT INTO services VALUES(49,'?Ъ?????????????А?????????????П ?З???Б?В???? ?????Ж?? + ???????А???В??????','?з???Б?В???? ?????Ж??','?Ъ?????????????Б?????П ?З???Б?В???? ?Б ???????А???В?????????? ?????П ?В???????????А???????????П ????????',3000,120,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(50,'?Ь???Б?Б???? ?????Ж?? ?Д?А?????Ж?Г???Б??????','?Ь???Б?Б???? ?????Ж??','?д?А?????Ж?Г???Б?????П ?В???Е???????? ?????Б?Б?????? ?????П ???????????????????П',2000,60,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(51,'XL-?Г?Е????','?г?Е???? ?????Ж?? ?Б ?????Б?Б????????','?н???Б?В?А??-?Г?Е???? ?Б ?????В?????Б???????Л?? ?????????????Б?В????????',3200,120,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(52,'XXI-?Г?Е????','?г?Е???? ?????Ж?? ?Б ?????Б?Б????????','?н???Б?????О?????????Л?? ?Г?Е???? ???А???????Г??-???????Б?Б??',3500,140,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(53,'?Ъ???А???????Б???В???А???????П','?г?Е???? ?????Ж?? ?????? ?????Б?Б??????','?в???А???????П ?Г???????????Б???Л?? ?????????? ?????П ?Г???Г?З?И???????П ???А???????????А???Й???????П',2000,45,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(54,'?Ф???А??????????','?г?Е???? ?????Ж?? ?????? ?????Б?Б??????','?Я?А???Д???Б?Б???????????М???Л?? ?Г?Е???? ?Ф???А??????????',2000,60,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(55,'?Ъ??????????????-?????В????','?г?Е???? ?????Ж?? ?????? ?????Б?Б??????','?Р???В???????Ж???П ???Л?А???????В???? ??????????????????',2000,60,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(56,'?Ь???Б???? ?Р?Д?А???????В?Л','?г?Е???? ?????Ж?? ?????? ?????Б?Б??????','?н???Б?????О???????????П ???????????????????О?Й???П ?????Б????',2500,60,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(57,'?Я?????????? (?????????????М???Л??, ???????Б?Б?????А??, ?????????????????Л??)','?Я????????????','?Я?А???Д???Б?Б???????????М???Л?? ???????????? ???? ???Л?????А: ?????????????М???Л??, ???????Б?Б?????А?? ?????? ?????????????????Л??',2000,45,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(58,'RF-?????Д?В??????','?Р???????А???В?????П ?????Б?????В???????????П','?а?????????З???Б?В???В???Л?? ?????Д?В?????? ?????П ???????В?П?????? ????????',2500,60,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(59,'RF-?????Д?В?????? ?????????М?З???В?Л??','?Р???????А???В?????П ?????Б?????В???????????П','?Ш???????М?З???В?Л?? ?А?????????З???Б?В???В???Л?? ?????Д?В??????',10000,60,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(60,'?Ь?????А???В?????? (30 ??????)','?Ь?????А???В??????','?Ь?????А???В???????????П ?В???А???????П ?????П ?В???????????А???????????П ???Л?И?Ж',1500,30,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(61,'?Ь?????А???В?????? (45 ??????)','?Ь?????А???В??????','?Я?А?????????????В?????М?????П ???????А???В???????????П ?В???А???????П',2000,45,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(62,'?Т?????????? ?????А??','?Ь?????А???В??????','?Ъ???А?А?????Ж???П ?????????М?????? ?????А???? ???????А???В??????????',1000,30,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(63,'?Ю???А???И???????????? ???А????????/?А???Б?????Ж','?Ю?Д???А???????????? ???А????????, ?А???Б?????Ж','?Я?А???Д???Б?Б???????????М?????? ?????А???И???????????? ???А???????? ?????? ?А???Б?????Ж',500,30,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(64,'?Ъ???А?А?????Ж???П ?????Б??????/???????Ж???В????','?Ю?Д???А???????????? ???А????????, ?А???Б?????Ж','?Ъ???А?А?????Ж???П ?Д???А???Л ???А???????? ?????Б?????? ?????? ???????Ж???В????',500,30,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(65,'?Ы???????????А???????????? ?А???Б?????Ж/???А????????','?Ю?Д???А???????????? ???А????????, ?А???Б?????Ж','?Ы???????????А???????????? ?????П ?Г?Е???????????????? ????????',2000,60,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(66,'?С?????????? ?????Г?????????П','?Ф?????????П?Ж???П','?У???Г?????????П ???????? ????????????',1300,30,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(67,'?С?????????? ???????Б?Б??????','?Ф?????????П?Ж???П','?Ъ?????Б?Б???З???Б?????П ???????? ????????????',1000,30,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(68,'?Я???????Л?И????','?Ф?????????П?Ж???П','?Ф?????????П?Ж???П ?????????Л?И???З???Л?Е ????????????',500,20,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(69,'?а?Г???? ???????????Б?В?М?О','?Ф?????????П?Ж???П','?Я?????????П ???????????П?Ж???П ?А?Г??',1200,45,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(70,'?Э?????? ???????????Б?В?М?О','?Ф?????????П?Ж???П','?Я?????????П ???????????П?Ж???П ??????',1500,60,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(71,'?Ъ?????????????Б','?Ф?????????П?Ж???П','?Ъ?????????????Б?????П ???????????П?Ж???П',3000,120,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(72,'?Ь???????В???А???????П','?Ь???????В???А???????П/?С?????А???????В???????????Ж???П/?С???В?????Б','?Ш???К?????Ж???????????П ?????????В???А???????П',3500,60,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(73,'?С?????А???????В???????????Ж???П','?Ь???????В???А???????П/?С?????А???????В???????????Ж???П/?С???В?????Б','?С?????А???????В???????????Ж???П ?????П ???????????????????П',5000,60,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(74,'?С???В?????Б','?Ь???????В???А???????П/?С?????А???????В???????????Ж???П/?С???В?????Б','?С???В?????Б-?В???А???????П ???В 2000 ?А?Г??',2000,45,1,'2025-10-26 23:40:40');
INSERT INTO services VALUES(75,'?Ъ?????Б?Г???М?В???Ж???П ?????Б?????В??????????','?Ъ?????Б?Г???М?В???Ж???П','?Я???А?????З?????П ???????Б?Г???М?В???Ж???П ?Б?????Ж?????????Б?В??',0,30,1,'2025-10-29 21:04:00');
INSERT INTO services VALUES(76,'?з???Б?В???? ?????Ж??','?г?Е?????????Л?? ???А???Ж?????Г?А?Л','?Я?А???Д???Б?Б???????????М?????П ?З???Б?В???? ?????Ж??',3000,60,1,'2025-10-29 21:04:00');
INSERT INTO services VALUES(77,'?С???В?????Б','?Ш???К?????Ж????','?Ъ???А?А?????Ж???П ?????А?Й???? ?????В?Г?????В?????Б????????',15000,45,1,'2025-10-29 21:04:00');
INSERT INTO services VALUES(78,'?С?????А???????В???????????Ж???П','?Ш???К?????Ж????','?г?????????????????? ?? ???????????????????? ????????',12000,60,1,'2025-10-29 21:04:00');
INSERT INTO services VALUES(79,'?Я??????????','?г?Е?????????Л?? ???А???Ж?????Г?А?Л','?е???????З???Б?????? ????????????',5000,45,1,'2025-10-29 21:04:00');
CREATE TABLE bookings (

    id INTEGER PRIMARY KEY AUTOINCREMENT,

    user_id INTEGER NOT NULL,

    service_id INTEGER NOT NULL,

    booking_date DATE NOT NULL,

    booking_time TIME NOT NULL,

    status VARCHAR(20) DEFAULT 'pending' CHECK(status IN ('pending', 'confirmed', 'cancelled', 'completed')),

    comment TEXT,

    telegram_notification BOOLEAN DEFAULT FALSE,

    notification_sent BOOLEAN DEFAULT FALSE,

    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (user_id) REFERENCES users (id),

    FOREIGN KEY (service_id) REFERENCES services (id)

);
CREATE TABLE telegram_links (

    id INTEGER PRIMARY KEY AUTOINCREMENT,

    user_id INTEGER NOT NULL,

    link_code VARCHAR(10) UNIQUE NOT NULL,

    telegram_id VARCHAR(100),

    telegram_username VARCHAR(100),

    is_verified BOOLEAN DEFAULT FALSE,

    expires_at DATETIME NOT NULL,

    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (user_id) REFERENCES users (id)

);
INSERT INTO telegram_links VALUES(8,1,'W9Y7MN','964264865','Grmmy',1,'2025-10-27T01:16:35.361Z','2025-10-27 01:06:35');
INSERT INTO telegram_links VALUES(9,1,'KYFPAT',NULL,NULL,0,'2025-10-27T10:17:55.406Z','2025-10-27 10:07:55');
INSERT INTO telegram_links VALUES(10,1,'NUI8K7','964264865','Grmmy',1,'2025-10-27T10:58:24.810Z','2025-10-27 10:48:24');
INSERT INTO telegram_links VALUES(11,22,'VK1RAS','964264865','Grmmy',1,'2025-10-29T19:32:39.686Z','2025-10-29 19:22:39');
INSERT INTO telegram_links VALUES(12,19,'AF296Y','964264865','Grmmy',1,'2025-10-29T20:19:21.495Z','2025-10-29 20:09:21');
INSERT INTO telegram_links VALUES(13,19,'2E8PLX','964264865','Grmmy',1,'2025-10-29T20:23:16.605Z','2025-10-29 20:13:16');
INSERT INTO telegram_links VALUES(14,19,'YZAHGW',NULL,NULL,0,'2025-10-29T20:23:44.904Z','2025-10-29 20:13:44');
INSERT INTO telegram_links VALUES(15,19,'O147M9',NULL,NULL,0,'2025-10-29T20:23:52.568Z','2025-10-29 20:13:52');
INSERT INTO telegram_links VALUES(16,19,'SAXC44',NULL,NULL,0,'2025-10-29T20:23:55.087Z','2025-10-29 20:13:55');
INSERT INTO telegram_links VALUES(17,19,'L0S9W7','7780599269','bobolie',1,'2025-10-29T20:24:44.305Z','2025-10-29 20:14:44');
CREATE TABLE notifications (

    id INTEGER PRIMARY KEY AUTOINCREMENT,

    user_id INTEGER NOT NULL,

    booking_id INTEGER,

    type VARCHAR(50) NOT NULL,

    title VARCHAR(255) NOT NULL,

    message TEXT NOT NULL,

    is_sent BOOLEAN DEFAULT FALSE,

    sent_at DATETIME,

    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY (user_id) REFERENCES users (id),

    FOREIGN KEY (booking_id) REFERENCES bookings (id)

);
INSERT INTO sqlite_sequence VALUES('users',25);
INSERT INTO sqlite_sequence VALUES('services',79);
INSERT INTO sqlite_sequence VALUES('telegram_links',17);
INSERT INTO sqlite_sequence VALUES('bookings',14);
CREATE INDEX idx_users_email ON users(email);
CREATE INDEX idx_users_phone ON users(phone);
CREATE INDEX idx_bookings_date ON bookings(booking_date);
CREATE INDEX idx_bookings_user_id ON bookings(user_id);
CREATE INDEX idx_telegram_links_code ON telegram_links(link_code);
CREATE INDEX idx_telegram_links_user_id ON telegram_links(user_id);
COMMIT;
